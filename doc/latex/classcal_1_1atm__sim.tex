\hypertarget{classcal_1_1atm__sim}{}\doxysection{cal\+::atm\+\_\+sim Class Reference}
\label{classcal_1_1atm__sim}\index{cal::atm\_sim@{cal::atm\_sim}}


Atmosphere creation, evolution and observation.  


\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classcal_1_1atm__sim}{atm\+\_\+sim}} $>$ \mbox{\hyperlink{classcal_1_1atm__sim_a2efa147f5c40596b8691aca2ac117b4e}{pshr}}
\item 
typedef std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classcal_1_1atm__sim}{atm\+\_\+sim}} $>$ \mbox{\hyperlink{classcal_1_1atm__sim_ab71557f3645d93a8f938d1de4b3ca537}{puniq}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classcal_1_1atm__sim_a4c84a0904937df49a959f138a51e8070}{atm\+\_\+sim}} (double azmin, double azmax, double elmin, double elmax, double tmin, double tmax, double lmin\+\_\+center=.\+01, double lmin\+\_\+sigma=.\+001, double lmax\+\_\+center=10, double lmax\+\_\+sigma=10, double w\+\_\+center=25, double w\+\_\+sigma=10, double wdir\+\_\+center=0, double wdir\+\_\+sigma=100, double z0\+\_\+center=2000, double z0\+\_\+sigma=0, double T0\+\_\+center=280, double T0\+\_\+sigma=10, double zatm=40000, double zmax=2000, double xstep=100, double ystep=100, double zstep=100, long \mbox{\hyperlink{classcal_1_1atm__sim_a9c4aa288a0e7fb1f4159a69243b5c37c}{nelem\+\_\+sim\+\_\+max}}=1000, int verbosity=0, uint64\+\_\+t key1=0, uint64\+\_\+t key2=0, uint64\+\_\+t counterval1=0, uint64\+\_\+t counterval2=0, std\+::string cachedir=std\+::string(), double \mbox{\hyperlink{classcal_1_1atm__sim_a5a61a854d54dba6f705dbd043ad3d1d2}{rmin}}=0, double rmax=10000)
\item 
\mbox{\hyperlink{classcal_1_1atm__sim_a064b7336503ca3f5765e498d6932bf65}{$\sim$atm\+\_\+sim}} ()
\item 
int \mbox{\hyperlink{classcal_1_1atm__sim_aa1b57cf734827f16c185e5b360a61304}{simulate}} (bool use\+\_\+cache)
\item 
int \mbox{\hyperlink{classcal_1_1atm__sim_a09f101d0f619a8b332ded6086a239011}{observe}} (double $\ast$t, double $\ast$az, double $\ast$el, double $\ast$tod, long nsamp, double fixed\+\_\+r=-\/1)
\item 
void \mbox{\hyperlink{classcal_1_1atm__sim_a87e928417af7835946935bd1e5924725}{print}} (std\+::ostream \&out=std\+::cout) const
\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classcal_1_1atm__sim_a1e80fd5484d31babaa988cb9548217c5}{draw}} ()
\item 
void \mbox{\hyperlink{classcal_1_1atm__sim_a78fbf25d493cc3829dc1549115eccdda}{get\+\_\+volume}} ()
\item 
bool \mbox{\hyperlink{classcal_1_1atm__sim_adb680fc272c1839241c9bedc99260381}{in\+\_\+cone}} (double x, double y, double z, double t\+\_\+in=-\/1)
\item 
void \mbox{\hyperlink{classcal_1_1atm__sim_a5d0e5635f88133858fa32fd1399481e7}{compress\+\_\+volume}} ()
\item 
void \mbox{\hyperlink{classcal_1_1atm__sim_ab1aa562093fbecc04cbbe34430901f00}{get\+\_\+slice}} (long \&ind\+\_\+start, long \&ind\+\_\+stop)
\item 
cholmod\+\_\+sparse $\ast$ \mbox{\hyperlink{classcal_1_1atm__sim_a88ba15ba34f30664f50feb493abc08b7}{sqrt\+\_\+sparse\+\_\+covariance}} (cholmod\+\_\+sparse $\ast$cov, long ind\+\_\+start, long ind\+\_\+stop)
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a2430d26138ece2d3aafa1e7b712deb7d}\label{classcal_1_1atm__sim_a2430d26138ece2d3aafa1e7b712deb7d}} 
cholmod\+\_\+sparse $\ast$ {\bfseries build\+\_\+sparse\+\_\+covariance} (long ind\+\_\+start, long ind\+\_\+stop)
\item 
void \mbox{\hyperlink{classcal_1_1atm__sim_afda9fbabb9aec95cae005f6f8c91cd9b}{apply\+\_\+sparse\+\_\+covariance}} (cholmod\+\_\+sparse $\ast$sqrt\+\_\+cov, long ind\+\_\+start, long ind\+\_\+stop)
\item 
void \mbox{\hyperlink{classcal_1_1atm__sim_abe59c32b1033744445f1f0fc7560ddfe}{ind2coord}} (long i, double $\ast$coord)
\item 
long \mbox{\hyperlink{classcal_1_1atm__sim_a926aeaeed11baaf629bbeacdd1182fa8}{coord2ind}} (double x, double y, double z)
\item 
double \mbox{\hyperlink{classcal_1_1atm__sim_a4de2152abacbe09d0e1918a3a602b3cc}{interp}} (double x, double y, double z, std\+::vector$<$ long $>$ \&last\+\_\+ind, std\+::vector$<$ double $>$ \&last\+\_\+nodes)
\item 
double \mbox{\hyperlink{classcal_1_1atm__sim_a1d355122632b5761cda5e782e6bd9b56}{cov\+\_\+eval}} (double $\ast$coord1, double $\ast$coord2)
\item 
void \mbox{\hyperlink{classcal_1_1atm__sim_a0c86db633c439e294ae7487c13a31ab9}{initialize\+\_\+kolmogorov}} ()
\item 
double \mbox{\hyperlink{classcal_1_1atm__sim_ab0e9c8b8c73323a1d134c9643c381891}{kolmogorov}} (double r)
\item 
void \mbox{\hyperlink{classcal_1_1atm__sim_a67f89876f41b03d42659ba0a320ed351}{smooth}} ()
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_adb77ee190e260902eb390b1ec9494297}\label{classcal_1_1atm__sim_adb77ee190e260902eb390b1ec9494297}} 
void {\bfseries load\+\_\+realization} ()
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a93ca3963f06c6ebdff5c192b7fe14d92}\label{classcal_1_1atm__sim_a93ca3963f06c6ebdff5c192b7fe14d92}} 
void {\bfseries save\+\_\+realization} ()
\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aa83997eb473c507734c1c728803d88be}\label{classcal_1_1atm__sim_aa83997eb473c507734c1c728803d88be}} 
std\+::string {\bfseries cachedir}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a2a0c4a0daed317c8cc2dcbd5f0e85541}\label{classcal_1_1atm__sim_a2a0c4a0daed317c8cc2dcbd5f0e85541}} 
int {\bfseries rank}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a256d7e2c6e4b9ac423a207680e87f673}\label{classcal_1_1atm__sim_a256d7e2c6e4b9ac423a207680e87f673}} 
int {\bfseries ntask}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a46b092ef4c4fa2c4c43892587805c54c}\label{classcal_1_1atm__sim_a46b092ef4c4fa2c4c43892587805c54c}} 
int {\bfseries nthread}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aadffa7b591e9a54c934996abce8871ea}\label{classcal_1_1atm__sim_aadffa7b591e9a54c934996abce8871ea}} 
int {\bfseries verbosity}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a16908b31eae22c3aa833a9f18bf85583}\label{classcal_1_1atm__sim_a16908b31eae22c3aa833a9f18bf85583}} 
uint64\+\_\+t {\bfseries key1}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a8a7ae924996a95a91f12b175abdc1abe}\label{classcal_1_1atm__sim_a8a7ae924996a95a91f12b175abdc1abe}} 
uint64\+\_\+t {\bfseries key2}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a91a0181c859774392dd504989dfce9a0}\label{classcal_1_1atm__sim_a91a0181c859774392dd504989dfce9a0}} 
uint64\+\_\+t {\bfseries counter1}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aea4f813fcb7f8ee15165c6e5de95ad01}\label{classcal_1_1atm__sim_aea4f813fcb7f8ee15165c6e5de95ad01}} 
uint64\+\_\+t {\bfseries counter2}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aa897d1bff0be6a1bb07517def6c45202}\label{classcal_1_1atm__sim_aa897d1bff0be6a1bb07517def6c45202}} 
uint64\+\_\+t {\bfseries counter1start}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ad4675e3ea2cae7342c239f0d0736d01b}\label{classcal_1_1atm__sim_ad4675e3ea2cae7342c239f0d0736d01b}} 
uint64\+\_\+t {\bfseries counter2start}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a78f05e632fd92bd0faa7545923a47fdd}\label{classcal_1_1atm__sim_a78f05e632fd92bd0faa7545923a47fdd}} 
double {\bfseries azmin}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a32c576617e2c78bde676258a0efa188f}\label{classcal_1_1atm__sim_a32c576617e2c78bde676258a0efa188f}} 
double {\bfseries azmax}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ae1b49bbd7311a3e7c11bac6b4168ddcd}\label{classcal_1_1atm__sim_ae1b49bbd7311a3e7c11bac6b4168ddcd}} 
double {\bfseries elmin}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a1e50fb8b6476aef6d92e3b170085a16b}\label{classcal_1_1atm__sim_a1e50fb8b6476aef6d92e3b170085a16b}} 
double {\bfseries elmax}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a870e368196ddafafac05e6abe3a6d8cb}\label{classcal_1_1atm__sim_a870e368196ddafafac05e6abe3a6d8cb}} 
double {\bfseries tmin}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a0217f418826db0e897c192cbee3a0e68}\label{classcal_1_1atm__sim_a0217f418826db0e897c192cbee3a0e68}} 
double {\bfseries tmax}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a49e27061e921b731b00dd860a4eb9c09}\label{classcal_1_1atm__sim_a49e27061e921b731b00dd860a4eb9c09}} 
double {\bfseries sinel0}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ac0def5214ec60c5ba6ac114bf5235ebd}\label{classcal_1_1atm__sim_ac0def5214ec60c5ba6ac114bf5235ebd}} 
double {\bfseries cosel0}
\item 
double \mbox{\hyperlink{classcal_1_1atm__sim_a00553913e9d0f5a9a0a5c1348ba1e0fc}{tanmin}}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a4928d0c1e73dc74bd647a54fadcfe9a6}\label{classcal_1_1atm__sim_a4928d0c1e73dc74bd647a54fadcfe9a6}} 
double {\bfseries tanmax}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_af14746ca9cd44d60cc88a9c317676520}\label{classcal_1_1atm__sim_af14746ca9cd44d60cc88a9c317676520}} 
double {\bfseries lmin\+\_\+center}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a2828a33d67014950853d565dadc31bef}\label{classcal_1_1atm__sim_a2828a33d67014950853d565dadc31bef}} 
double {\bfseries lmin\+\_\+sigma}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a66c6637c3060d18eed1a81358c9367a0}\label{classcal_1_1atm__sim_a66c6637c3060d18eed1a81358c9367a0}} 
double {\bfseries lmax\+\_\+center}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aa47ee1e9a986181031ebd354f4de86b9}\label{classcal_1_1atm__sim_aa47ee1e9a986181031ebd354f4de86b9}} 
double {\bfseries lmax\+\_\+sigma}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a5f2fe9055b450eecd2a78eb65a103edf}\label{classcal_1_1atm__sim_a5f2fe9055b450eecd2a78eb65a103edf}} 
double {\bfseries w\+\_\+center}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ad033cc4e25a5e245a3e96be0b1d545f2}\label{classcal_1_1atm__sim_ad033cc4e25a5e245a3e96be0b1d545f2}} 
double {\bfseries w\+\_\+sigma}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a8c4ac33fac8f250a25d8f69268ef1bcd}\label{classcal_1_1atm__sim_a8c4ac33fac8f250a25d8f69268ef1bcd}} 
double {\bfseries wdir\+\_\+center}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a5496fbe15cf7b2869ed743c5a992e7f7}\label{classcal_1_1atm__sim_a5496fbe15cf7b2869ed743c5a992e7f7}} 
double {\bfseries wdir\+\_\+sigma}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a3a3813d84c495e564f4ac65edd5ea791}\label{classcal_1_1atm__sim_a3a3813d84c495e564f4ac65edd5ea791}} 
double {\bfseries z0\+\_\+center}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a2a9076a789eeb1562ec089f69f1230aa}\label{classcal_1_1atm__sim_a2a9076a789eeb1562ec089f69f1230aa}} 
double {\bfseries z0\+\_\+sigma}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_af0c91dc32a5316808e479b5e3c1323e0}\label{classcal_1_1atm__sim_af0c91dc32a5316808e479b5e3c1323e0}} 
double {\bfseries T0\+\_\+center}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ab0054db1b8631f8552d373ac30a59ca0}\label{classcal_1_1atm__sim_ab0054db1b8631f8552d373ac30a59ca0}} 
double {\bfseries T0\+\_\+sigma}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_abe3487c524c68eca51104ab0b03961ab}\label{classcal_1_1atm__sim_abe3487c524c68eca51104ab0b03961ab}} 
double {\bfseries z0inv}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a7b9e9c386497f6d0bace1b2a984d2c10}\label{classcal_1_1atm__sim_a7b9e9c386497f6d0bace1b2a984d2c10}} 
double {\bfseries az0}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a29c2d9d264892bf389a6344e2d18d96b}\label{classcal_1_1atm__sim_a29c2d9d264892bf389a6344e2d18d96b}} 
double {\bfseries el0}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ad562dbede266ed6b9bc461be5eb6fe63}\label{classcal_1_1atm__sim_ad562dbede266ed6b9bc461be5eb6fe63}} 
double {\bfseries delta\+\_\+az}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aadd43ade0c233771c5ebb16f1bd8f3da}\label{classcal_1_1atm__sim_aadd43ade0c233771c5ebb16f1bd8f3da}} 
double {\bfseries delta\+\_\+el}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a8841374d8ac28cedbe7911534593e87c}\label{classcal_1_1atm__sim_a8841374d8ac28cedbe7911534593e87c}} 
double {\bfseries delta\+\_\+t}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aa753f312988a08b2fd089febbe7eff68}\label{classcal_1_1atm__sim_aa753f312988a08b2fd089febbe7eff68}} 
double {\bfseries zatm}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a1345c3b2668e96cc76d334f6c80696e1}\label{classcal_1_1atm__sim_a1345c3b2668e96cc76d334f6c80696e1}} 
double {\bfseries zmax}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a23f1e240e2dc9a586f01f5dc478cfd9c}\label{classcal_1_1atm__sim_a23f1e240e2dc9a586f01f5dc478cfd9c}} 
double {\bfseries xstep}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aa4baaff4f08d8596f813c38297c7e833}\label{classcal_1_1atm__sim_aa4baaff4f08d8596f813c38297c7e833}} 
double {\bfseries ystep}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aae452dae36718418bbd148572e9131e4}\label{classcal_1_1atm__sim_aae452dae36718418bbd148572e9131e4}} 
double {\bfseries zstep}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aa4fc130686e7505f91f0a023e485fd53}\label{classcal_1_1atm__sim_aa4fc130686e7505f91f0a023e485fd53}} 
double {\bfseries delta\+\_\+x}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a1d7b934039c7babf409e29157632fae0}\label{classcal_1_1atm__sim_a1d7b934039c7babf409e29157632fae0}} 
double {\bfseries delta\+\_\+y}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a63f9e12085395a9b57b1f5fb578f62e7}\label{classcal_1_1atm__sim_a63f9e12085395a9b57b1f5fb578f62e7}} 
double {\bfseries delta\+\_\+z}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a617e2ac51bbada924b3f2de1e391ad0b}\label{classcal_1_1atm__sim_a617e2ac51bbada924b3f2de1e391ad0b}} 
double {\bfseries xstart}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a33ff0cc63193e8be221dbd69e6afc0ec}\label{classcal_1_1atm__sim_a33ff0cc63193e8be221dbd69e6afc0ec}} 
double {\bfseries ystart}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a325e420ade80586a194106adaa0b74f4}\label{classcal_1_1atm__sim_a325e420ade80586a194106adaa0b74f4}} 
double {\bfseries zstart}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a4d38be4c029cc61f2a7354ba76c52eab}\label{classcal_1_1atm__sim_a4d38be4c029cc61f2a7354ba76c52eab}} 
double {\bfseries xxstep}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ad75d98f1f0d502af1185d311ba2b0f81}\label{classcal_1_1atm__sim_ad75d98f1f0d502af1185d311ba2b0f81}} 
double {\bfseries yystep}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a72c90b0484fa2bed589ac8bdf60fae4b}\label{classcal_1_1atm__sim_a72c90b0484fa2bed589ac8bdf60fae4b}} 
double {\bfseries zzstep}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a78c31ad6382f80567983e37e407f288f}\label{classcal_1_1atm__sim_a78c31ad6382f80567983e37e407f288f}} 
double {\bfseries delta\+\_\+y\+\_\+cone}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a129ccca6f62ed6083ad93806e391e064}\label{classcal_1_1atm__sim_a129ccca6f62ed6083ad93806e391e064}} 
double {\bfseries delta\+\_\+z\+\_\+cone}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_adff6cf7a3113ee8f03ed5dd835355a0e}\label{classcal_1_1atm__sim_adff6cf7a3113ee8f03ed5dd835355a0e}} 
double {\bfseries maxdist}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a6dad6dd69644c08f0c7d536ccf012681}\label{classcal_1_1atm__sim_a6dad6dd69644c08f0c7d536ccf012681}} 
double {\bfseries xstepinv}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a605b8f68c7186bca3f0ee12242ad8bdd}\label{classcal_1_1atm__sim_a605b8f68c7186bca3f0ee12242ad8bdd}} 
double {\bfseries ystepinv}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a6a6f769b4f05a46efb6a77e7a5201a5d}\label{classcal_1_1atm__sim_a6a6f769b4f05a46efb6a77e7a5201a5d}} 
double {\bfseries zstepinv}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aaa756002b8aa58126275083883b6cdbc}\label{classcal_1_1atm__sim_aaa756002b8aa58126275083883b6cdbc}} 
long {\bfseries nx}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a7a3b8f2a6c1b035e780c7bf2bfc45efc}\label{classcal_1_1atm__sim_a7a3b8f2a6c1b035e780c7bf2bfc45efc}} 
long {\bfseries ny}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a3b8c5f61cbbbd3529138b037c573d450}\label{classcal_1_1atm__sim_a3b8c5f61cbbbd3529138b037c573d450}} 
long {\bfseries nz}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a01516b3ab24be4b1fa3fd0aa090493be}\label{classcal_1_1atm__sim_a01516b3ab24be4b1fa3fd0aa090493be}} 
long {\bfseries nn}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a7977a81f7abaff59fe1fa5583501e084}\label{classcal_1_1atm__sim_a7977a81f7abaff59fe1fa5583501e084}} 
long {\bfseries xstride}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a679d8a761bf8657e66711c5a949f9ef5}\label{classcal_1_1atm__sim_a679d8a761bf8657e66711c5a949f9ef5}} 
long {\bfseries ystride}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a2018be206f9be9ffdbb6f3a6f43c5e63}\label{classcal_1_1atm__sim_a2018be206f9be9ffdbb6f3a6f43c5e63}} 
long {\bfseries zstride}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a9a583db67440b0eb3b98be93f36026d5}\label{classcal_1_1atm__sim_a9a583db67440b0eb3b98be93f36026d5}} 
double {\bfseries xstrideinv}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aa837ea200ec1069e9dce1131d8a3bdbc}\label{classcal_1_1atm__sim_aa837ea200ec1069e9dce1131d8a3bdbc}} 
double {\bfseries ystrideinv}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ab4598106f91970376b672fc1da5a6a4c}\label{classcal_1_1atm__sim_ab4598106f91970376b672fc1da5a6a4c}} 
double {\bfseries zstrideinv}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ab28add91f057cf8bb96bcdd25d1a2efa}\label{classcal_1_1atm__sim_ab28add91f057cf8bb96bcdd25d1a2efa}} 
size\+\_\+t {\bfseries nelem}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_adda0bd8f69ac8f4882660a4fe1d461be}\label{classcal_1_1atm__sim_adda0bd8f69ac8f4882660a4fe1d461be}} 
bool {\bfseries cached} = false
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_af674fc000a72fda1a307ec960c763c91}\label{classcal_1_1atm__sim_af674fc000a72fda1a307ec960c763c91}} 
double {\bfseries lmin}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ab3087355e67cc8b914f8fd3071ea5807}\label{classcal_1_1atm__sim_ab3087355e67cc8b914f8fd3071ea5807}} 
double {\bfseries lmax}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a4768e06942550e494db5b62c30777e4f}\label{classcal_1_1atm__sim_a4768e06942550e494db5b62c30777e4f}} 
double {\bfseries w}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_af03ce265a91e9cde98f2ab9f68c346da}\label{classcal_1_1atm__sim_af03ce265a91e9cde98f2ab9f68c346da}} 
double {\bfseries wdir}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a3f10a40b8b8406340023c0f892f19603}\label{classcal_1_1atm__sim_a3f10a40b8b8406340023c0f892f19603}} 
double {\bfseries z0}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a4a277560156cdecf8954ef3b9293198a}\label{classcal_1_1atm__sim_a4a277560156cdecf8954ef3b9293198a}} 
double {\bfseries T0}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_adf4a07f800cae54e78ab988c6aa14348}\label{classcal_1_1atm__sim_adf4a07f800cae54e78ab988c6aa14348}} 
double {\bfseries wx}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a6f2288e0551a55c61bc4fbdaf7103e88}\label{classcal_1_1atm__sim_a6f2288e0551a55c61bc4fbdaf7103e88}} 
double {\bfseries wy}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a943e53f8feb4d36b4f1d7b951c0c74d1}\label{classcal_1_1atm__sim_a943e53f8feb4d36b4f1d7b951c0c74d1}} 
double {\bfseries wz}
\item 
long \mbox{\hyperlink{classcal_1_1atm__sim_a5f54691e621793733e29c7d34bb7fe2e}{nr}}
\item 
long \mbox{\hyperlink{classcal_1_1atm__sim_a9c4aa288a0e7fb1f4159a69243b5c37c}{nelem\+\_\+sim\+\_\+max}}
\item 
double \mbox{\hyperlink{classcal_1_1atm__sim_ac86dbe5bd63fb8ee60c388f61a92d22c}{rmin\+\_\+kolmo}}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ad59b4450e258ef3f5121ab4aaf9a9234}\label{classcal_1_1atm__sim_ad59b4450e258ef3f5121ab4aaf9a9234}} 
double {\bfseries rmax\+\_\+kolmo}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a5e034c704cdefbbc4bf2f79117144395}\label{classcal_1_1atm__sim_a5e034c704cdefbbc4bf2f79117144395}} 
double {\bfseries rstep}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a90817ed3f012f0349c941df98488c648}\label{classcal_1_1atm__sim_a90817ed3f012f0349c941df98488c648}} 
double {\bfseries rstep\+\_\+inv}
\item 
double \mbox{\hyperlink{classcal_1_1atm__sim_af86ced8dda72a44f84ad0d77fd0587a5}{rcorr}}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a0c064e5463f79ab17df6f6b082c27a29}\label{classcal_1_1atm__sim_a0c064e5463f79ab17df6f6b082c27a29}} 
double {\bfseries rcorrsq}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a9353f58263fd14c6ebf435919c024e96}\label{classcal_1_1atm__sim_a9353f58263fd14c6ebf435919c024e96}} 
double {\bfseries corrlim}
\item 
double \mbox{\hyperlink{classcal_1_1atm__sim_a5a61a854d54dba6f705dbd043ad3d1d2}{rmin}}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a49a6dacf8fe3e58016a31032d428c7ec}\label{classcal_1_1atm__sim_a49a6dacf8fe3e58016a31032d428c7ec}} 
double {\bfseries rmax}
\item 
vec\+\_\+long \mbox{\hyperlink{classcal_1_1atm__sim_ab961936c27c9b58799e845234dea0486}{compressed\+\_\+index}}
\item 
vec\+\_\+long \mbox{\hyperlink{classcal_1_1atm__sim_afb3b80ebd3c9e5ac7f48d94809bdb836}{full\+\_\+index}}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aee5389b9d7e119e2bfd5cdb656d531f8}\label{classcal_1_1atm__sim_aee5389b9d7e119e2bfd5cdb656d531f8}} 
cholmod\+\_\+common {\bfseries cholcommon}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a0f5c87ff46e2b06d9d1ed7918c8706da}\label{classcal_1_1atm__sim_a0f5c87ff46e2b06d9d1ed7918c8706da}} 
cholmod\+\_\+common $\ast$ {\bfseries chcommon}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_ab458948e636a2d2b3752d5cf2d502283}\label{classcal_1_1atm__sim_ab458948e636a2d2b3752d5cf2d502283}} 
vec\+\_\+double {\bfseries realization}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_aa7ec36e873c07849f729fb145cc1e920}\label{classcal_1_1atm__sim_aa7ec36e873c07849f729fb145cc1e920}} 
std\+::vector$<$ double $>$ {\bfseries kolmo\+\_\+x}
\item 
\mbox{\Hypertarget{classcal_1_1atm__sim_a7741f50d547ee0a20c566763b1a6a5b8}\label{classcal_1_1atm__sim_a7741f50d547ee0a20c566763b1a6a5b8}} 
std\+::vector$<$ double $>$ {\bfseries kolmo\+\_\+y}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Atmosphere creation, evolution and observation. 

\doxysubsection{Member Typedef Documentation}
\mbox{\Hypertarget{classcal_1_1atm__sim_a2efa147f5c40596b8691aca2ac117b4e}\label{classcal_1_1atm__sim_a2efa147f5c40596b8691aca2ac117b4e}} 
\index{cal::atm\_sim@{cal::atm\_sim}!pshr@{pshr}}
\index{pshr@{pshr}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{pshr}{pshr}}
{\footnotesize\ttfamily typedef std\+::shared\+\_\+ptr$<$\mbox{\hyperlink{classcal_1_1atm__sim}{atm\+\_\+sim}}$>$ \mbox{\hyperlink{classcal_1_1atm__sim_a2efa147f5c40596b8691aca2ac117b4e}{cal\+::atm\+\_\+sim\+::pshr}}}

Helper name for shared pointer (Objects of shared\+\_\+ptr types have the ability of taking ownership of a pointer and share that ownership\+: once they take ownership, the group of owners of a pointer become responsible for its deletion when the last one of them releases that ownership.) \mbox{\Hypertarget{classcal_1_1atm__sim_ab71557f3645d93a8f938d1de4b3ca537}\label{classcal_1_1atm__sim_ab71557f3645d93a8f938d1de4b3ca537}} 
\index{cal::atm\_sim@{cal::atm\_sim}!puniq@{puniq}}
\index{puniq@{puniq}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{puniq}{puniq}}
{\footnotesize\ttfamily typedef std\+::unique\+\_\+ptr$<$\mbox{\hyperlink{classcal_1_1atm__sim}{atm\+\_\+sim}}$>$ \mbox{\hyperlink{classcal_1_1atm__sim_ab71557f3645d93a8f938d1de4b3ca537}{cal\+::atm\+\_\+sim\+::puniq}}}

Helper name for unique pointer (These objects have the ability of taking ownership of a pointer\+: once they take ownership they manage the pointed object by becoming responsible for its deletion at some point. The unique\+\_\+ptr objects automatically delete the object they manage (using a deleter) as soon as they themselves are destroyed, or as soon as their value changes either by an assignment operation or by an explicit call to unique\+\_\+ptr\+::reset. ) 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classcal_1_1atm__sim_a4c84a0904937df49a959f138a51e8070}\label{classcal_1_1atm__sim_a4c84a0904937df49a959f138a51e8070}} 
\index{cal::atm\_sim@{cal::atm\_sim}!atm\_sim@{atm\_sim}}
\index{atm\_sim@{atm\_sim}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{atm\_sim()}{atm\_sim()}}
{\footnotesize\ttfamily cal\+::atm\+\_\+sim\+::atm\+\_\+sim (\begin{DoxyParamCaption}\item[{double}]{azmin,  }\item[{double}]{azmax,  }\item[{double}]{elmin,  }\item[{double}]{elmax,  }\item[{double}]{tmin,  }\item[{double}]{tmax,  }\item[{double}]{lmin\+\_\+center = {\ttfamily .01},  }\item[{double}]{lmin\+\_\+sigma = {\ttfamily .001},  }\item[{double}]{lmax\+\_\+center = {\ttfamily 10},  }\item[{double}]{lmax\+\_\+sigma = {\ttfamily 10},  }\item[{double}]{w\+\_\+center = {\ttfamily 25},  }\item[{double}]{w\+\_\+sigma = {\ttfamily 10},  }\item[{double}]{wdir\+\_\+center = {\ttfamily 0},  }\item[{double}]{wdir\+\_\+sigma = {\ttfamily 100},  }\item[{double}]{z0\+\_\+center = {\ttfamily 2000},  }\item[{double}]{z0\+\_\+sigma = {\ttfamily 0},  }\item[{double}]{T0\+\_\+center = {\ttfamily 280},  }\item[{double}]{T0\+\_\+sigma = {\ttfamily 10},  }\item[{double}]{zatm = {\ttfamily 40000},  }\item[{double}]{zmax = {\ttfamily 2000},  }\item[{double}]{xstep = {\ttfamily 100},  }\item[{double}]{ystep = {\ttfamily 100},  }\item[{double}]{zstep = {\ttfamily 100},  }\item[{long}]{nelem\+\_\+sim\+\_\+max = {\ttfamily 1000},  }\item[{int}]{verbosity = {\ttfamily 0},  }\item[{uint64\+\_\+t}]{key1 = {\ttfamily 0},  }\item[{uint64\+\_\+t}]{key2 = {\ttfamily 0},  }\item[{uint64\+\_\+t}]{counterval1 = {\ttfamily 0},  }\item[{uint64\+\_\+t}]{counterval2 = {\ttfamily 0},  }\item[{std\+::string}]{cachedir = {\ttfamily std\+:\+:string()},  }\item[{double}]{rmin = {\ttfamily 0},  }\item[{double}]{rmax = {\ttfamily 10000} }\end{DoxyParamCaption})}

Contructror for \mbox{\hyperlink{classcal_1_1atm__sim}{atm\+\_\+sim}} class. This is the version N\+O\+N-\/\+M\+PI. The class get from the \mbox{\hyperlink{classcal_1_1_environment}{Environment}} class the M\+A\+X\+\_\+\+T\+H\+R\+S\+\_\+\+N\+UM and split the parallelization from them. This version of the library is not indicated from H\+P\+C-\/cluster but it\textquotesingle{}s for personal use on your laptop.

For a more cluster-\/oriented implementation see the class \mbox{\hyperlink{classcal_1_1mpi__atm__sim}{mpi\+\_\+atm\+\_\+sim}}. Check the sky patch boundary that you are going to observe Not it works fine only for sky-\/patch. \mbox{\hyperlink{struct_a}{A}} lot of efforts are needed to improve a continuos scanning strategy like Q\+U\+I\+J\+O\+TE / S\+T\+R\+IP / and others (L\+AT?)
\begin{DoxyParams}{Parameters}
{\em azmin} & C\+ES azimutal range \\
\hline
{\em azmax} & C\+ES azimutal range \\
\hline
{\em elmin} & C\+ES elevation range \\
\hline
{\em elmax} & C\+ES elevation range \\
\hline
{\em tmin} & C\+ES time range \\
\hline
{\em tmax} & C\+ES time range \\
\hline
{\em lmin\+\_\+center} & Dissipation scale of the Kolmogorov turbulence \mbox{[}m\mbox{]} with its sigma \\
\hline
{\em lmax\+\_\+center} & Injection scale of the Kolmogorov turbulence \mbox{[}m\mbox{]} with its sigma \\
\hline
{\em w\+\_\+center} & Wind speed \mbox{[}m/s\mbox{]} with its sigma \\
\hline
{\em wdir\+\_\+center} & Wind direction \mbox{[}radians\mbox{]} with its sigma \\
\hline
{\em z0\+\_\+center} & Water vapor distribution \mbox{[}m\mbox{]} with its sigma \\
\hline
{\em T0\+\_\+center} & Ground temperature \mbox{[}K\mbox{]} with its sigma \\
\hline
{\em zatm} & Atmosphere extent for temperature profile \mbox{[}m\mbox{]} \\
\hline
{\em zmax} & Water vapor extent for integration \mbox{[}m\mbox{]} \\
\hline
{\em xstep} & Size of the volume elements \mbox{[}elements\mbox{]} \\
\hline
{\em nelem\+\_\+sim\+\_\+max} & Size of the simulation slices \mbox{[}elements\mbox{]} \\
\hline
{\em verbosity} & Verbosity \mbox{[}bool\mbox{]} \\
\hline
{\em key1} & The R\+NG keys. In this constructur the \mbox{\hyperlink{classcal_1_1atm__sim}{atm\+\_\+sim}} R\+NG has two different keys, key1 and key2 \\
\hline
{\em counterval1} & The R\+NG counters\+: counterval1 and 2. Define the quantity of numbers that every thrads have to extract. \\
\hline
{\em cachedir} & The chacedir is used by the class in order to save atmospheric realizations in order to save time for multi-\/color simulation. The same atmosphere is just scaling for the extintion (provided by lib A\+A\+TM) \\
\hline
{\em rmin} & Line-\/of-\/sight observing limit \mbox{[}m\mbox{]} (rmin and rmax by default 0, 10000) \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classcal_1_1atm__sim_a064b7336503ca3f5765e498d6932bf65}\label{classcal_1_1atm__sim_a064b7336503ca3f5765e498d6932bf65}} 
\index{cal::atm\_sim@{cal::atm\_sim}!````~atm\_sim@{$\sim$atm\_sim}}
\index{````~atm\_sim@{$\sim$atm\_sim}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{$\sim$atm\_sim()}{~atm\_sim()}}
{\footnotesize\ttfamily cal\+::atm\+\_\+sim\+::$\sim$atm\+\_\+sim (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

We don\textquotesingle{}t neet a D\+T\+OR carefully definition. The unique\+\_\+ptr(s) are authomatically free once they are derefenced. 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classcal_1_1atm__sim_afda9fbabb9aec95cae005f6f8c91cd9b}\label{classcal_1_1atm__sim_afda9fbabb9aec95cae005f6f8c91cd9b}} 
\index{cal::atm\_sim@{cal::atm\_sim}!apply\_sparse\_covariance@{apply\_sparse\_covariance}}
\index{apply\_sparse\_covariance@{apply\_sparse\_covariance}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{apply\_sparse\_covariance()}{apply\_sparse\_covariance()}}
{\footnotesize\ttfamily void cal\+::atm\+\_\+sim\+::apply\+\_\+sparse\+\_\+covariance (\begin{DoxyParamCaption}\item[{cholmod\+\_\+sparse $\ast$}]{sqrt\+\_\+cov,  }\item[{long}]{ind\+\_\+start,  }\item[{long}]{ind\+\_\+stop }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Create a realization out of the square root covariance matrix \mbox{\Hypertarget{classcal_1_1atm__sim_a5d0e5635f88133858fa32fd1399481e7}\label{classcal_1_1atm__sim_a5d0e5635f88133858fa32fd1399481e7}} 
\index{cal::atm\_sim@{cal::atm\_sim}!compress\_volume@{compress\_volume}}
\index{compress\_volume@{compress\_volume}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{compress\_volume()}{compress\_volume()}}
{\footnotesize\ttfamily void cal\+::atm\+\_\+sim\+::compress\+\_\+volume (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Find the volume elements really needed \mbox{\Hypertarget{classcal_1_1atm__sim_a926aeaeed11baaf629bbeacdd1182fa8}\label{classcal_1_1atm__sim_a926aeaeed11baaf629bbeacdd1182fa8}} 
\index{cal::atm\_sim@{cal::atm\_sim}!coord2ind@{coord2ind}}
\index{coord2ind@{coord2ind}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{coord2ind()}{coord2ind()}}
{\footnotesize\ttfamily long cal\+::atm\+\_\+sim\+::coord2ind (\begin{DoxyParamCaption}\item[{double}]{x,  }\item[{double}]{y,  }\item[{double}]{z }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

X Y Z -\/ coordinates to Compressed index \mbox{\Hypertarget{classcal_1_1atm__sim_a1d355122632b5761cda5e782e6bd9b56}\label{classcal_1_1atm__sim_a1d355122632b5761cda5e782e6bd9b56}} 
\index{cal::atm\_sim@{cal::atm\_sim}!cov\_eval@{cov\_eval}}
\index{cov\_eval@{cov\_eval}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{cov\_eval()}{cov\_eval()}}
{\footnotesize\ttfamily double cal\+::atm\+\_\+sim\+::cov\+\_\+eval (\begin{DoxyParamCaption}\item[{double $\ast$}]{coord1,  }\item[{double $\ast$}]{coord2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Evaluate the covariance matrix \mbox{\Hypertarget{classcal_1_1atm__sim_a1e80fd5484d31babaa988cb9548217c5}\label{classcal_1_1atm__sim_a1e80fd5484d31babaa988cb9548217c5}} 
\index{cal::atm\_sim@{cal::atm\_sim}!draw@{draw}}
\index{draw@{draw}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{draw()}{draw()}}
{\footnotesize\ttfamily void cal\+::atm\+\_\+sim\+::draw (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Draw values of lmin, lmax, w, wdir T0 (and optionally z0).

Draw 10 000 gaussian variates to use in the drawing the simulation parameters

Precalculate the ratio for covariance

The wind is parallel to the surface, and it\textquotesingle{}s indipendent to z. It\textquotesingle{}s a good practice transform the coordinate in order to rotate the frame where the scan is across the X-\/axis.

We take into account the opposite of the wind speed v = -\/v, in this way we can apply this to the telescope position. By example, S. Church 1995 (the paragraph of the wind) \mbox{\Hypertarget{classcal_1_1atm__sim_ab1aa562093fbecc04cbbe34430901f00}\label{classcal_1_1atm__sim_ab1aa562093fbecc04cbbe34430901f00}} 
\index{cal::atm\_sim@{cal::atm\_sim}!get\_slice@{get\_slice}}
\index{get\_slice@{get\_slice}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{get\_slice()}{get\_slice()}}
{\footnotesize\ttfamily void cal\+::atm\+\_\+sim\+::get\+\_\+slice (\begin{DoxyParamCaption}\item[{long \&}]{ind\+\_\+start,  }\item[{long \&}]{ind\+\_\+stop }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Find the next range of compressed indices to simulate \mbox{\Hypertarget{classcal_1_1atm__sim_a78fbf25d493cc3829dc1549115eccdda}\label{classcal_1_1atm__sim_a78fbf25d493cc3829dc1549115eccdda}} 
\index{cal::atm\_sim@{cal::atm\_sim}!get\_volume@{get\_volume}}
\index{get\_volume@{get\_volume}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{get\_volume()}{get\_volume()}}
{\footnotesize\ttfamily void cal\+::atm\+\_\+sim\+::get\+\_\+volume (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Determine the rectangular volume needed

Trim zmax if rmax sets a more stringent limit Horizontal volume Cone witdth \mbox{\Hypertarget{classcal_1_1atm__sim_adb680fc272c1839241c9bedc99260381}\label{classcal_1_1atm__sim_adb680fc272c1839241c9bedc99260381}} 
\index{cal::atm\_sim@{cal::atm\_sim}!in\_cone@{in\_cone}}
\index{in\_cone@{in\_cone}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{in\_cone()}{in\_cone()}}
{\footnotesize\ttfamily bool cal\+::atm\+\_\+sim\+::in\+\_\+cone (\begin{DoxyParamCaption}\item[{double}]{x,  }\item[{double}]{y,  }\item[{double}]{z,  }\item[{double}]{t\+\_\+in = {\ttfamily -\/1} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

determine of the given coordinates are within observed volume \mbox{\Hypertarget{classcal_1_1atm__sim_abe59c32b1033744445f1f0fc7560ddfe}\label{classcal_1_1atm__sim_abe59c32b1033744445f1f0fc7560ddfe}} 
\index{cal::atm\_sim@{cal::atm\_sim}!ind2coord@{ind2coord}}
\index{ind2coord@{ind2coord}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{ind2coord()}{ind2coord()}}
{\footnotesize\ttfamily void cal\+::atm\+\_\+sim\+::ind2coord (\begin{DoxyParamCaption}\item[{long}]{i,  }\item[{double $\ast$}]{coord }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Compressed index to X Y Z -\/ coordinates \mbox{\Hypertarget{classcal_1_1atm__sim_a0c86db633c439e294ae7487c13a31ab9}\label{classcal_1_1atm__sim_a0c86db633c439e294ae7487c13a31ab9}} 
\index{cal::atm\_sim@{cal::atm\_sim}!initialize\_kolmogorov@{initialize\_kolmogorov}}
\index{initialize\_kolmogorov@{initialize\_kolmogorov}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{initialize\_kolmogorov()}{initialize\_kolmogorov()}}
{\footnotesize\ttfamily void cal\+::atm\+\_\+sim\+::initialize\+\_\+kolmogorov (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Integrate the correlation from the Kolmorov spectrum \mbox{\Hypertarget{classcal_1_1atm__sim_a4de2152abacbe09d0e1918a3a602b3cc}\label{classcal_1_1atm__sim_a4de2152abacbe09d0e1918a3a602b3cc}} 
\index{cal::atm\_sim@{cal::atm\_sim}!interp@{interp}}
\index{interp@{interp}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{interp()}{interp()}}
{\footnotesize\ttfamily double cal\+::atm\+\_\+sim\+::interp (\begin{DoxyParamCaption}\item[{double}]{x,  }\item[{double}]{y,  }\item[{double}]{z,  }\item[{std\+::vector$<$ long $>$ \&}]{last\+\_\+ind,  }\item[{std\+::vector$<$ double $>$ \&}]{last\+\_\+nodes }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Interpolate the realization value to given coordinates \mbox{\Hypertarget{classcal_1_1atm__sim_ab0e9c8b8c73323a1d134c9643c381891}\label{classcal_1_1atm__sim_ab0e9c8b8c73323a1d134c9643c381891}} 
\index{cal::atm\_sim@{cal::atm\_sim}!kolmogorov@{kolmogorov}}
\index{kolmogorov@{kolmogorov}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{kolmogorov()}{kolmogorov()}}
{\footnotesize\ttfamily double cal\+::atm\+\_\+sim\+::kolmogorov (\begin{DoxyParamCaption}\item[{double}]{r }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Interpolate the correlation from precomputed grid \mbox{\Hypertarget{classcal_1_1atm__sim_a09f101d0f619a8b332ded6086a239011}\label{classcal_1_1atm__sim_a09f101d0f619a8b332ded6086a239011}} 
\index{cal::atm\_sim@{cal::atm\_sim}!observe@{observe}}
\index{observe@{observe}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{observe()}{observe()}}
{\footnotesize\ttfamily int cal\+::atm\+\_\+sim\+::observe (\begin{DoxyParamCaption}\item[{double $\ast$}]{t,  }\item[{double $\ast$}]{az,  }\item[{double $\ast$}]{el,  }\item[{double $\ast$}]{tod,  }\item[{long}]{nsamp,  }\item[{double}]{fixed\+\_\+r = {\ttfamily -\/1} }\end{DoxyParamCaption})}

Observe the atmosphere at that specific time along a specific line of sight \mbox{\Hypertarget{classcal_1_1atm__sim_a87e928417af7835946935bd1e5924725}\label{classcal_1_1atm__sim_a87e928417af7835946935bd1e5924725}} 
\index{cal::atm\_sim@{cal::atm\_sim}!print@{print}}
\index{print@{print}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{print()}{print()}}
{\footnotesize\ttfamily void cal\+::atm\+\_\+sim\+::print (\begin{DoxyParamCaption}\item[{std\+::ostream \&}]{out = {\ttfamily std\+:\+:cout} }\end{DoxyParamCaption}) const}

Helper function for print \mbox{\Hypertarget{classcal_1_1atm__sim_aa1b57cf734827f16c185e5b360a61304}\label{classcal_1_1atm__sim_aa1b57cf734827f16c185e5b360a61304}} 
\index{cal::atm\_sim@{cal::atm\_sim}!simulate@{simulate}}
\index{simulate@{simulate}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{simulate()}{simulate()}}
{\footnotesize\ttfamily int cal\+::atm\+\_\+sim\+::simulate (\begin{DoxyParamCaption}\item[{bool}]{use\+\_\+cache }\end{DoxyParamCaption})}

Simulate the atmosphere time evolution

Bla bla bla qualcosa su simulate \mbox{\Hypertarget{classcal_1_1atm__sim_a67f89876f41b03d42659ba0a320ed351}\label{classcal_1_1atm__sim_a67f89876f41b03d42659ba0a320ed351}} 
\index{cal::atm\_sim@{cal::atm\_sim}!smooth@{smooth}}
\index{smooth@{smooth}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{smooth()}{smooth()}}
{\footnotesize\ttfamily void cal\+::atm\+\_\+sim\+::smooth (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Smooths the realization \mbox{\Hypertarget{classcal_1_1atm__sim_a88ba15ba34f30664f50feb493abc08b7}\label{classcal_1_1atm__sim_a88ba15ba34f30664f50feb493abc08b7}} 
\index{cal::atm\_sim@{cal::atm\_sim}!sqrt\_sparse\_covariance@{sqrt\_sparse\_covariance}}
\index{sqrt\_sparse\_covariance@{sqrt\_sparse\_covariance}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{sqrt\_sparse\_covariance()}{sqrt\_sparse\_covariance()}}
{\footnotesize\ttfamily cholmod\+\_\+sparse $\ast$ cal\+::atm\+\_\+sim\+::sqrt\+\_\+sparse\+\_\+covariance (\begin{DoxyParamCaption}\item[{cholmod\+\_\+sparse $\ast$}]{cov,  }\item[{long}]{ind\+\_\+start,  }\item[{long}]{ind\+\_\+stop }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Use the atmospheric parameters for volume element covariance Cholesky decompose (square root) the covariance matrix

Cholesky-\/factorize the provided sparse matrix and return the sparse matrix representation of the factorization 

\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classcal_1_1atm__sim_ab961936c27c9b58799e845234dea0486}\label{classcal_1_1atm__sim_ab961936c27c9b58799e845234dea0486}} 
\index{cal::atm\_sim@{cal::atm\_sim}!compressed\_index@{compressed\_index}}
\index{compressed\_index@{compressed\_index}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{compressed\_index}{compressed\_index}}
{\footnotesize\ttfamily vec\+\_\+long cal\+::atm\+\_\+sim\+::compressed\+\_\+index\hspace{0.3cm}{\ttfamily [private]}}

Mapping between full volume and observation cone \mbox{\Hypertarget{classcal_1_1atm__sim_afb3b80ebd3c9e5ac7f48d94809bdb836}\label{classcal_1_1atm__sim_afb3b80ebd3c9e5ac7f48d94809bdb836}} 
\index{cal::atm\_sim@{cal::atm\_sim}!full\_index@{full\_index}}
\index{full\_index@{full\_index}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{full\_index}{full\_index}}
{\footnotesize\ttfamily vec\+\_\+long cal\+::atm\+\_\+sim\+::full\+\_\+index\hspace{0.3cm}{\ttfamily [private]}}

Inverse mapping between full volume and observation cone \mbox{\Hypertarget{classcal_1_1atm__sim_a9c4aa288a0e7fb1f4159a69243b5c37c}\label{classcal_1_1atm__sim_a9c4aa288a0e7fb1f4159a69243b5c37c}} 
\index{cal::atm\_sim@{cal::atm\_sim}!nelem\_sim\_max@{nelem\_sim\_max}}
\index{nelem\_sim\_max@{nelem\_sim\_max}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{nelem\_sim\_max}{nelem\_sim\_max}}
{\footnotesize\ttfamily long cal\+::atm\+\_\+sim\+::nelem\+\_\+sim\+\_\+max\hspace{0.3cm}{\ttfamily [private]}}

Size of the independent X-\/direction slices \mbox{\Hypertarget{classcal_1_1atm__sim_a5f54691e621793733e29c7d34bb7fe2e}\label{classcal_1_1atm__sim_a5f54691e621793733e29c7d34bb7fe2e}} 
\index{cal::atm\_sim@{cal::atm\_sim}!nr@{nr}}
\index{nr@{nr}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{nr}{nr}}
{\footnotesize\ttfamily long cal\+::atm\+\_\+sim\+::nr\hspace{0.3cm}{\ttfamily [private]}}

Number of steps in the Kolmogorov grid \mbox{\Hypertarget{classcal_1_1atm__sim_af86ced8dda72a44f84ad0d77fd0587a5}\label{classcal_1_1atm__sim_af86ced8dda72a44f84ad0d77fd0587a5}} 
\index{cal::atm\_sim@{cal::atm\_sim}!rcorr@{rcorr}}
\index{rcorr@{rcorr}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{rcorr}{rcorr}}
{\footnotesize\ttfamily double cal\+::atm\+\_\+sim\+::rcorr\hspace{0.3cm}{\ttfamily [private]}}

Correlation length \mbox{\Hypertarget{classcal_1_1atm__sim_a5a61a854d54dba6f705dbd043ad3d1d2}\label{classcal_1_1atm__sim_a5a61a854d54dba6f705dbd043ad3d1d2}} 
\index{cal::atm\_sim@{cal::atm\_sim}!rmin@{rmin}}
\index{rmin@{rmin}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{rmin}{rmin}}
{\footnotesize\ttfamily double cal\+::atm\+\_\+sim\+::rmin\hspace{0.3cm}{\ttfamily [private]}}

Line-\/of-\/sight integration limits \mbox{\Hypertarget{classcal_1_1atm__sim_ac86dbe5bd63fb8ee60c388f61a92d22c}\label{classcal_1_1atm__sim_ac86dbe5bd63fb8ee60c388f61a92d22c}} 
\index{cal::atm\_sim@{cal::atm\_sim}!rmin\_kolmo@{rmin\_kolmo}}
\index{rmin\_kolmo@{rmin\_kolmo}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{rmin\_kolmo}{rmin\_kolmo}}
{\footnotesize\ttfamily double cal\+::atm\+\_\+sim\+::rmin\+\_\+kolmo\hspace{0.3cm}{\ttfamily [private]}}

Kolmogorov correlation grid \mbox{\Hypertarget{classcal_1_1atm__sim_a00553913e9d0f5a9a0a5c1348ba1e0fc}\label{classcal_1_1atm__sim_a00553913e9d0f5a9a0a5c1348ba1e0fc}} 
\index{cal::atm\_sim@{cal::atm\_sim}!tanmin@{tanmin}}
\index{tanmin@{tanmin}!cal::atm\_sim@{cal::atm\_sim}}
\doxysubsubsection{\texorpdfstring{tanmin}{tanmin}}
{\footnotesize\ttfamily double cal\+::atm\+\_\+sim\+::tanmin\hspace{0.3cm}{\ttfamily [private]}}

Helper coordinate for the in-\/cone calculation 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/include/C\+A\+L\+Atm\+Sim.\+hpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/C\+A\+L\+Atm\+Sim.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/compress\+\_\+volume.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/coord\+\_\+transform.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/covariance\+\_\+apply.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/covariance\+\_\+build.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/covariance\+\_\+eval.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/covariance\+\_\+square.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/draw.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/get\+\_\+slice.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/get\+\_\+volume.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/in\+\_\+cone.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/kolmogorov\+\_\+init.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/kolmovorov\+\_\+autocov.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/load\+\_\+save\+\_\+realization.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/observe.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/print.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/simulation.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/smooth\+\_\+interpolation.\+cpp\item 
/home/algebrato/\+Progetti/\+C\+M\+B4\+G/libcal/src/libcal/src/smoothing\+\_\+kernel.\+cpp\end{DoxyCompactItemize}
